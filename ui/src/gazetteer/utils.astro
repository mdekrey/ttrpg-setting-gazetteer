---
import { removeExtension } from '@/util/pathManipulation';
import { processUrlRoot } from '@/util/paths';
import { pathToFileURL } from 'node:url';

export async function getGazetteerEntries() {
	const articles = await Astro.glob('/gazetteer/**/*.mdx');

	return articles
		.map(article => ({
			...article,
			url: removeExtension(pathToFileURL(article.file).href.substring(processUrlRoot.href.length + 1)),
		}))
		.filter(article => !!article.frontmatter.title);
}
---